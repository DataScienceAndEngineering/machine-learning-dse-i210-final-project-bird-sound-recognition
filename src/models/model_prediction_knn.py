# -*- coding: utf-8 -*-
"""model_prediction_KNN.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1EwtfGLA83C3CLc3DYz3gMHvH2vznGZLm
"""

import numpy as np
from sklearn.metrics import accuracy_score, classification_report
import joblib
from google.colab import drive

def evaluate_knn_model(model_path, label_encoder_path, X_test, y_test):
    model = joblib.load(model_path)
    le = joblib.load(label_encoder_path)
    y_test_encoded = le.transform(y_test)

    y_pred = model.predict(X_test)
    accuracy = accuracy_score(y_test_encoded, y_pred)
    report = classification_report(y_test_encoded, y_pred)

    return accuracy, report

def main():
    # Mount Google Drive
    drive.mount('/content/drive')

    # MFCC features
    X_test_mfcc = np.load('/content/drive/MyDrive/archive/X_test_mfcc.npy')
    y_test_mfcc = np.load('/content/drive/MyDrive/archive/y_test_mfcc.npy', allow_pickle=True)
    accuracy_mfcc, report_mfcc = evaluate_knn_model('/content/drive/MyDrive/archive/knn_model_mfcc.pkl', '/content/drive/MyDrive/archive/label_encoder_mfcc.pkl', X_test_mfcc, y_test_mfcc)
    print(f"MFCC Features - Accuracy: {accuracy_mfcc}\n{report_mfcc}")

    # Log-mel features
    X_test_log_mel = np.load('/content/drive/MyDrive/archive/X_test_log_mel.npy')
    y_test_log_mel = np.load('/content/drive/MyDrive/archive/y_test_log_mel.npy', allow_pickle=True)
    accuracy_log_mel, report_log_mel = evaluate_knn_model('/content/drive/MyDrive/archive/knn_model_log_mel.pkl', '/content/drive/MyDrive/archive/label_encoder_log_mel.pkl', X_test_log_mel, y_test_log_mel)
    print(f"Log-mel Features - Accuracy: {accuracy_log_mel}\n{report_log_mel}")

    # Waveform features
    X_test_waveform = np.load('/content/drive/MyDrive/archive/X_test_waveform.npy')
    y_test_waveform = np.load('/content/drive/MyDrive/archive/y_test_waveform.npy', allow_pickle=True)
    accuracy_waveform, report_waveform = evaluate_knn_model('/content/drive/MyDrive/archive/knn_model_waveform.pkl', '/content/drive/MyDrive/archive/label_encoder_waveform.pkl', X_test_waveform, y_test_waveform)
    print(f"Waveform Features - Accuracy: {accuracy_waveform}\n{report_waveform}")

if __name__ == "__main__":
    main()